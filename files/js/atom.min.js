(function(e,t,n){function u(e){return e&&r.call(e)=="[object Function]"}function a(e,t){if(typeof e!="object"){var n=e;e={};if(n!=null){e[n]=t}}return e}function f(e,t){return e.indexOf(t)>=0}function l(e,t){if(!f(e,t)){e.push(t)}return e}function c(e,t){t=e.indexOf(t);if(t!=-1){e.splice(t,1)}return e}function h(e,t){for(var n=e.length;n--;){if(e[n]==t){e.splice(n,1)}}return e}function p(e){return s.call(e)}function d(e){return e&&(t.isArray(e)||typeof e!="string"&&!u(e)&&typeof e.nodeName!="string"&&typeof e.length=="number")}function v(e,t){if(t)for(var n in t)if(i.call(t,n)){e[n]=t[n]}return e}var r=e.prototype.toString,i=e.prototype.hasOwnProperty,s=t.prototype.slice,o=this.atom=function(){if(o.initialize)return o.initialize.apply(this,arguments)};o.global=this;if(!Function.prototype.bind){Function.prototype.bind=function(e){if(typeof this!=="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=s.call(arguments,1),n=this,r=function(){},i=function(){var i;try{i=this instanceof r}catch(o){i=false}return n.apply(i?this:e||{},t.concat(s.call(arguments)))};r.prototype=n.prototype;i.prototype=new r;return i}}if(!e.keys)(function(t){e.keys=function(n){if(n!==e(n))throw new TypeError("Object.keys called on non-object");var r=[],i;for(i in n)if(t.call(n,i))r.push(i);return r}})({}.hasOwnProperty);if(!t.isArray){t.isArray=function(e){return e&&r.call(e)==="[object Array]"}}if(!e.create){e.create=function(e){function t(){}if(arguments.length>1){throw new Error("Object.create implementation only accepts the first parameter.")}t.prototype=e;return new t}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(!String.prototype.trimLeft){String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}}if(!String.prototype.trimRight){String.prototype.trimRight=function(){return this.replace(/\s+$/g,"")}}new function(){function e(e){return function(t,n){return e.call(this,a(t,n))}}function n(e){return function(t,n){t=a(t,n);for(var r in t)e.call(this,r,t[r]);return this}}function r(e,n){return function(r){if(t.isArray(r)){var i={},s,o;for(var u=r.length;u--;){s=r[u];o=e.call(this,s);if(!n||typeof o!=="undefined"){i[s]=o}}return i}return e.call(this,r)}}function i(e){var t=o.core.overloadSetter(e.set);return function(n,r){if(typeof r==="undefined"&&typeof n!=="object"){return e.get.call(this,n)}else{return t.call(this,n,r)}}}o.core={isFunction:u,objectize:a,contains:f,eraseOne:c,eraseAll:h,toArray:p,append:v,isArrayLike:d,includeUnique:l,slickAccessor:i,overloadSetter:n,overloadGetter:r,ensureObjectSetter:e};o.toArray=p;o.log=function(){throw new Error("deprecated")};o.isArrayLike=d;o.append=v};(function(e){var t=!!e.getOwnPropertyDescriptor,n=!!{}.__defineGetter__;if(!t&&!n)throw new Error("Accessors are not supported");var r=n?function(e,t,n){var r=e.__lookupGetter__(t),i=e.__lookupSetter__(t),s=!!(r||i);if(n)return s;return s?{get:r,set:i}:null}:function(t,n,r){var i=e.getOwnPropertyDescriptor(t,n);if(!i){var s=e.getPrototypeOf(t);if(s)return o.accessors.lookup(s,n,r)}else if(i.set||i.get){if(r)return true;return{set:i.set,get:i.get}}return r?false:null};var i=n?function(e,t,n){if(n){if(n.get)e.__defineGetter__(t,n.get);if(n.set)e.__defineSetter__(t,n.set)}return e}:function(t,n,r){if(r){var i={get:r.get,set:r.set,configurable:true,enumerable:true};e.defineProperty(t,n,i)}return t};o.accessors={lookup:r,define:function(e,t,n){if(typeof t=="object"){for(var r in t)i(e,r,t[r])}else{i(e,t,n)}return e},has:function(e,t){return o.accessors.lookup(e,t,true)},inherit:function(e,t,n){var r=o.accessors.lookup(e,n);if(r){o.accessors.define(t,n,r);return true}return false}}})(e);(function(e,r){var i={Tag:/^[-_a-z0-9]+$/i,Class:/^\.[-_a-z0-9]+$/i,Id:/^#[-_a-z0-9]+$/i},s=t.isArray,u=function(e){e.preventDefault();return false},a={zIndex:true,fontWeight:true,opacity:true,zoom:true,lineHeight:true},c=false,m=[],g=function(e){return String(e).replace(/-\D/g,function(e){return e[1].toUpperCase()})},y=function(e){return String(e).replace(/[A-Z]/g,function(e){return"-"+e[0].toLowerCase()})},b=function(){if(c)return;c=true;for(var e=0;e<m.length;){m[e++]()}m=[]},w=function(e,t){if(t==null||t<0)t=1;if(!e||t<=0)return o.dom(e);return w(e.parentNode,t-1)};r.addEventListener("DOMContentLoaded",b,false);e.addEventListener("load",b,false);var E=function(t,i){if(!(this instanceof E)){return new E(t,i)}if(!arguments.length){this.elems=[r];return this}if(!i&&t==="body"){this.elems=[r.body];return this}if(i!==n){return(new E(i||r)).find(t)}i=i||r;if(typeof t=="function"&&!(t instanceof E)){var s=t.bind(this,o,E);c?setTimeout(s,1):m.push(s);return this}var u=this.elems=t==e?[r]:t instanceof E?p(t.elems):d(t)?p(t):typeof t=="string"?E.query(i,t):E.find(i,t);if(u.length==1&&u[0]==null){u.length=0}return this};v(E,{query:function(e,t){return t.match(i.Id)?[(e.getElementById?e:r).getElementById(t.substr(1))]:t.match(i.Class)?p(e.getElementsByClassName(t.substr(1))):t.match(i.Tag)?p(e.getElementsByTagName(t)):p(e.querySelectorAll(t))},find:function(e,t){if(!t)return e==null?[]:[e];var n=t.nodeName?[t]:typeof t=="string"?E.query(e,t):[e];return n.length==1&&n[0]==null?[]:n},create:function(e,t){var n=new E(r.createElement(e));if(t)n.attr(t);return n},isElement:function(e){return!!(e&&e.nodeName)}});E.prototype={constructor:E,elems:[],get length(){return this.elems?this.elems.length:0},get body(){return this.find("body")},get first(){return this.elems[0]},get:function(e){return this.elems[Number(e)||0]},parent:function(e){return w(this.first,e)},contains:function(e){var t=this.first;e=o.dom(e).first;if(e)while(e=e.parentNode){if(e==t){return true}}return false},filter:function(e){var t=null;if(e.match(i.Tag)){e=e.toUpperCase();t="tagName"}else if(e.match(i.Id)){e=e.substr(1).toUpperCase();t="id"}return new E(this.elems.filter(function(n){if(t){return n[t].toUpperCase()==e}else{return n.parentNode&&p(n.parentNode.querySelectorAll(e)).indexOf(n)>=0}}))},is:function(e){return this.filter(e).length>0},html:function(e){if(e!=null){this.first.innerHTML=e;return this}else{return this.first.innerHTML}},text:function(e){var t=r.body.innerText==null?"textContent":"innerText";if(e==null){return this.first[t]}this.first[t]=e;return this},create:function(e,t,n){if(typeof t=="object"){n=t;t=0}o.dom.create(e,n).appendTo(this.get(t));return this},each:function(e){this.elems.forEach(e.bind(this));return this},attr:o.core.slickAccessor({get:function(e){return this.first.getAttribute(e)},set:function(e,t){var n=this.elems,r=n.length;while(r--){n[r].setAttribute(e,t)}}}),css:o.core.slickAccessor({get:function(t){return e.getComputedStyle(this.first,"").getPropertyValue(y(t))},set:function(e,t){var n=this.elems,r=n.length;while(r--){if(typeof t=="number"&&!a[e]){t+="px"}n[r].style[g(e)]=t}}}),addEvent:o.core.overloadSetter(function(t,n){if(n===false)n=u;this.each(function(i){if(i==r&&t=="load")i=e;i.addEventListener(t,n,false)});return this}),removeEvent:o.core.overloadSetter(function(t,n){if(n===false)n=u;this.each(function(i){if(i==r&&t=="load")i=e;i.removeEventListener(t,n,false)});return this}),bind:function(e,t){return this.addEvent.apply(this,arguments)},unbind:function(e,t){return this.removeEvent.apply(this,arguments)},delegate:function(e,t,n){return this.bind(t,function(t){if((new E(t.target)).is(e)){n.apply(this,arguments)}})},wrap:function(e){e=(new E(e)).first;return this.replaceWith(e).appendTo(e)},replaceWith:function(e){var t=this.first;e=E(e).first;t.parentNode.replaceChild(e,t);return this},find:function(e){var t=[];this.each(function(n){var r=0,i=E.find(n,e),s=i.length;while(r<s)l(t,i[r++])});return new E(t)},appendTo:function(e){var t=r.createDocumentFragment();this.each(function(e){t.appendChild(e)});E(e).first.appendChild(t);return this},appendBefore:function(e){var t=r.createDocumentFragment();this.each(function(e){t.appendChild(e)});E(e).parent().first.insertBefore(t,E(e).first);return this},appendAfter:function(e){var t=E(e).parent().first;var n=E(e).first.nextSibling;var i=r.createDocumentFragment();this.each(function(e){i.appendChild(e)});if(n){t.insertBefore(i,n)}else{t.appendChild(i)}return this},manipulateClass:function(e,t){if(!e)return this;if(!s(e))e=[e];return this.each(function(n){var r,i=n.className.split(/\s+/);for(r=e.length;r--;){t.call(this,i,e[r])}n.className=i.join(" ").trim()})},addClass:function(e){return this.manipulateClass(e,l)},removeClass:function(e){return this.manipulateClass(e,h)},toggleClass:function(e){return this.manipulateClass(e,function(e,t){var n=e.indexOf(t);if(n===-1){e.push(t)}else{e.splice(n,1)}})},hasClass:function(e){if(!e)return this;if(!s(e))e=[e];var t=false;this.each(function(n){if(t)return;var r=e.length,i=n.className.split(/\s+/);while(r--)if(!f(i,e[r])){return}t=true});return t},offset:function(){var t=this.first;if(t.offsetX!=null){return{x:t.offsetX,y:t.offsetY}}var n=t.getBoundingClientRect(),i=r.body,s=r.documentElement,o=e.pageXOffset||s.scrollLeft||i.scrollLeft,u=e.pageYOffset||s.scrollTop||i.scrollTop,a=s.clientLeft||i.clientLeft||0,f=s.clientTop||i.clientTop||0;return{x:Math.round(n.left+o-a),y:Math.round(n.top+u-f)}},clone:function(e){var t=0,n=[];if(e==null)e=true;for(;t<this.elems.length;t++){n.push(this.elems[t].cloneNode(e))}return o.dom(n)},empty:function(){return this.each(function(e){while(e.hasChildNodes()){e.removeChild(e.firstChild)}})},log:function(){console.log("atom.dom: ",this.elems);return this},destroy:function(){return this.each(function(e){if(e.parentNode){e.parentNode.removeChild(e)}})}};o.dom=E})(window,window.document);new function(){function e(e){return function(t,n){if(n==null){n=t;t=o}var r=e?t.prototype:t,s=o.accessors&&o.accessors.inherit;for(var u in n)if(u!="constructor"){if(s&&s(n,r,u))continue;r[u]=i(n[u])}return t}}function n(e){if(e==null)return"null";var t=r.call(e);for(var i in n.types)if(i==t)return n.types[i];if(e.nodeName){if(e.nodeType==1)return"element";if(e.nodeType==3)return/\S/.test(e.nodeValue)?"textnode":"whitespace"}var s=typeof e;if(e&&s=="object"){if(o.Class&&e instanceof o.Class)return"class";if(d(e))return"arguments"}return s}function i(e){var t=n(e);return t in i.types?i.types[t](e):e}n.types={};["Boolean","Number","String","Function","Array","Date","RegExp","Class"].forEach(function(e){n.types["[object "+e+"]"]=e.toLowerCase()});i.types={array:function(e){var n=e.length,r=new t(n);while(n--)r[n]=i(e[n]);return r},"class":function(e){return typeof e.clone=="function"?e.clone():e},object:function(e){if(typeof e.clone=="function")return e.clone();var t={},n=o.accessors&&o.accessors.inherit;for(var r in e){if(n&&n(e,t,r))continue;t[r]=i(e[r])}return t}};o.core.extend=e(false);o.core.implement=e(true);o.core.typeOf=n;o.core.clone=i;o.extend=o.core.extend;o.implement=o.core.implement;o.typeOf=o.core.typeOf;o.clone=o.core.clone};(function(){var e=o.core.extend,t=function(){};var n=function(t){var r,i,s,o,u;i={};e(i,n.defaultProps);e(i,t);i.headers={};e(i.headers,n.defaultHeaders);e(i.headers,t.headers);r=n.stringify(i.data);o=new XMLHttpRequest;u=i.url;s=i.method.toUpperCase();if(s=="GET"&&r){u+=(u.indexOf("?")==-1?"?":"&")+r}if(!i.cache){u+=(u.indexOf("?")==-1?"?":"&")+"_no_cache="+Date.now()}o.onreadystatechange=n.onready(o,i);o.open(s,u,true);for(var a in i.headers){o.setRequestHeader(a,i.headers[a])}o.send(s=="POST"&&r?r:null)};n.stringify=function(e){if(!e)return"";if(typeof e=="string"||typeof e=="number")return String(e);var t=[],n=encodeURIComponent;for(var r in e)if(e.hasOwnProperty(r)){t.push(n(r)+"="+n(e[r]))}return t.join("&")};n.defaultProps={interval:0,type:"plain",method:"post",data:{},headers:{},cache:false,url:location.href,onLoad:t,onError:t};n.defaultHeaders={"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"};n.onready=function(e,t){return function(n){if(e.readyState==4){if(e.status!=200)return t.onError(n);var r=e.responseText;if(t.type.toLowerCase()=="json"){r=JSON.parse(r)}if(t.interval>0)setTimeout(function(){o.ajax(t)},t.interval*1e3);t.onLoad(r)}}};o.ajax=n})();o.dom.prototype.ajax=function(e){e=v({},e);var t=this;if(e.onLoad){e.onLoad=e.onLoad.bind(t)}else{e.onLoad=function(e){t.first.innerHTML=e}}if(e.onError)e.onError=e.onError.bind(t);o.ajax(e);return t};o.cookie={get:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},set:function(e,t,n){n=n||{};var r=n.expires;if(r){if(typeof r=="number"){r=new Date(r*1e3+Date.now())}if(r.toUTCString){r=r.toUTCString()}n.expires=r}var i=[e+"="+encodeURIComponent(t)];for(var s in n)i.push(n[s]===true?s:s+"="+n[s]);document.cookie=i.join("; ");return o.cookie},del:function(e){return o.cookie.set(e,"",{expires:-1})}};(function(){function u(){if(!t){e=Date.now();s(f);t=true}}function a(){var t,i,s,o=Date.now(),u=Math.min(o-e,1e3);for(i=0,s=r.length;i<s;i++){c(n,r[i])}r.length=0;for(i=0,s=n.length;i<s;i++){t=n[i];if(r.indexOf(t)==-1){t.call(null,u)}}e=o}function f(){s(f);if(n.length==0){r.length=0;e=Date.now()}else a()}var e,t=false,n=[],r=[],i=16,s=function(e){window.setTimeout(e,i)};o.frame={add:function(e){u();l(n,e)},remove:function(e){if(t)l(r,e)}}})();(function(e){function n(e){this.supports=e}function r(e){return t?t+e:e[0].toLowerCase()+e.substr(1)}function i(t){return e[r("PointerLockElement")]===t}var t="pointerLockElement"in e?"":"mozPointerLockElement"in e?"moz":"webkitPointerLockElement"in e?"webkit":null;if(t==null){n.prototype={locked:function(){return false},request:function(){},exit:function(){}}}else{e.addEventListener("mousemove",function(t){if(s&&i(s)){t.movementX=t[r("MovementX")]||0;t.movementY=t[r("MovementY")]||0;u&&u(t)}},false);var s=false,u=null;n.prototype={locked:function(e){return i(e||s)},request:function(e,t){s=e;u=t;e[r("RequestPointerLock")]()},exit:function(){s=null;u=null;e[r("ExitPointerLock")]()}}}o.pointerLock=new n(t!=null)})(document);new function(){var e=function(e){var t=o.uri.options,n=t.parser.exec(e||window.location.href),r={},i=14;while(i--)r[t.key[i]]=n[i]||"";r[t.q.name]={};r[t.key[12]].replace(t.q.parser,function(e,n,i){if(n)r[t.q.name][n]=i});return r};e.options={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};o.uri=e};(function(e){var n=e.core.typeOf,r=e.core.extend,i=e.accessors.inherit,s="prototype",o=function(e){return function(){return e}},u=false;var a=function(e){if(u)return this;if(typeof e=="function"&&n(e)=="function")e={initialize:e};var t=function(){if(this instanceof t){if(u)return this;return this.initialize?this.initialize.apply(this,arguments):this}else{return t.invoke.apply(t,arguments)}};r(t,a);t.prototype=c(a);t.implement(e,false).reserved(true,{parent:f,self:t}).reserved({factory:function(){function e(e){return t.apply(this,e)}e.prototype=t.prototype;return function(t){return new e(t||[])}}()});t.prototype.constructor=t;return t};var f=function(){if(!this.$caller)throw new Error("The method «parent» cannot be called.");var e=this.$caller.$name,t=this.$caller.$owner.parent,n=t&&t.prototype[e];if(!n)throw new Error("The method «"+e+"» has no parent.");return n.apply(this,arguments)};var l=function(t,n,r){if(r.$origin)r=r.$origin;var i=function(){if(!this||this==e.global)throw new TypeError("Context lost");if(r.$protected&&!this.$caller)throw new Error("The method «"+n+"» is protected.");var t=this.$caller;this.$caller=i;var s=r.apply(this,arguments);this.$caller=t;return s};i.$owner=t;i.$origin=r;i.$name=n;return i};var c=function(t){if(e.declare&&t instanceof e.declare){return e.declare.config.methods.proto(t)}u=true;var n=new t;u=false;return n};a.extend=function(e,t){if(typeof e=="string"){var n={};n[e]=t}else{n=e}for(var r in n)if(!i(n,this,r)){this[r]=n[r]}return this};a.extend({implement:function(t,r,s){if(typeof t=="string"){var o={};o[t]=r}else{o=t;s=r}for(var u in o){if(!i(o,this.prototype,u)){var f=o[u];if(a.Mutators.hasOwnProperty(u)){f=a.Mutators[u].call(this,f);if(f==null)continue}if(typeof f=="function"&&n(f)=="function"){if(f.$origin)f=f.$origin;if(f.$hidden=="next"){f.$hidden=true}else if(f.$hidden){continue}this.prototype[u]=s?f:l(this,u,f)}else{this.prototype[u]=e.clone(f)}}}return this},mixin:function(){t.from(arguments).forEach(function(e){this.implement(c(e))}.bind(this));return this},reserved:function(t,n){if(arguments.length==1){n=t;t=false}var r=t?this.prototype:this;for(var i in n){e.accessors.define(r,i,{get:o(n[i])})}return this},isInstance:function(e){return e instanceof this},invoke:function(){return this.factory(arguments)},Mutators:{Extends:function(e){if(e==null)throw new TypeError("Cant extends from null");this.extend(e).reserved({parent:e});this.prototype=c(e)},Implements:function(e){this.mixin.apply(this,t.from(e))},Static:function(e){this.extend(e)}},abstractMethod:function(){throw new Error("Abstract Method «"+this.$caller.$name+"» called")},protectedMethod:function(e){return r(e,{$protected:true})},hiddenMethod:function(e){return r(e,{$hidden:"next"})}});a.abstractMethod.$abstract=true;e.Class=a})(o);o.Class.bindAll=function(e,t){if(typeof t=="string"){if(t!="$caller"&&!o.accessors.has(e,t)&&u(e[t])){e[t]=e[t].bind(e)}}else if(t){for(var n=t.length;n--;)o.Class.bindAll(e,t[n])}else{for(var n in e)o.Class.bindAll(e,n)}return e};new function(){var n=o.Class;var r=function(e,n,r){var i=n.apply(this,t.from(r||[]));if(typeof i=="string"&&i.toLowerCase()=="removeevent"){this.removeEvent(e,n)}};var i=function(e){return(e||"").replace(/^on([A-Z])/,function(e,t){return t.toLowerCase()})};var s=function(e,t){if(t||!e._events)e._events={$ready:{}}};var u=function(e){u.fn.push(e);if(!u.id){u.id=function(){u.reset().invoke()}.delay(1)}};u.reset=function(){var e=u.fn;u.fn=[];u.id=0;return e};u.reset();v(n,{Events:n({addEvent:function(n,o){s(this);var u,a,f=[];if(arguments.length==1&&typeof n!="string"){for(u in n){this.addEvent(u,n[u])}}else if(t.isArray(n)){for(u=0,a=n.length;u<a;u++){this.addEvent(n[u],o)}}else{n=i(n);if(n=="$ready"){throw new TypeError("Event name «$ready» is reserved")}else if(!o){throw new TypeError("Function is empty")}else{e.ifEmpty(this._events,n,[]);this._events[n].include(o);var l=this._events.$ready[n];if(l)r.apply(this,[n,o,l,f]);f.invoke()}}return this},removeEvent:function(e,n){if(!arguments.length){s(this,true);return this}s(this);if(t.isArray(e)){for(var r=e.length;r--;){this.removeEvent(e[r],n)}}else if(arguments.length==1&&typeof e!="string"){for(r in e){this.removeEvent(r,e[r])}}else{e=i(e);if(e=="$ready"){throw new TypeError("Event name «$ready» is reserved")}else if(arguments.length==1){this._events[e]=[]}else if(e in this._events){this._events[e].erase(n)}}return this},isEventAdded:function(e){s(this);var t=this._events[e];return!!(t&&t.length)},fireEvent:function(e,t){s(this);e=i(e);var n=o.clone(this._events[e]);if(n){var u=n.length,a=0;for(;a<u;a++)r.call(this,e,n[a],t||[])}return this},readyEvent:function(e,t){s(this);u(function(){e=i(e);this._events.$ready[e]=t||[];this.fireEvent(e,t||[])}.bind(this));return this}})})};new function(){var e=function(e,t){return function(){var n="_"+e,r=this;return n in r?r[n]:r[n]=t.call(r)}};o.Class.Mutators.Generators=function(e){o.Class.Mutators.Generators.init(this,e)};o.Class.Mutators.Generators.init=function(t,n){for(var r in n)o.accessors.define(t.prototype,r,{get:e(r,n[r])})}};o.Class.Options=o.Class({options:{},fastSetOptions:false,setOptions:function(){if(!this.options){this.options={}}else if(this.options==this.self.prototype.options){if(this.fastSetOptions){this.options=v({},this.options)}else{this.options=o.clone(this.options)}}var e=this.options;for(var t=arguments,n=0,r=t.length;n<r;n++){if(typeof t[n]=="object"){if(this.fastSetOptions){v(e,t[n])}else{o.extend(e,t[n])}}}if(this.addEvent)for(var i in e){if(o.typeOf(e[i])=="function"&&/^on[A-Z]/.test(i)){this.addEvent(i,e[i]);delete e[i]}}return this}});var m=function(e){var n,r,i=e.accessors.inherit,s=false,o=false,a=[];n=function(e,t,n){if(o)return this;n=r.prepareParams(e,t,n);var i=function(){return r.construct.call(this,i,arguments)};if(n.name){i=(new Function("con",'return {"'+n.name+'": '+function(){return con.apply(this,arguments)}+'}["'+n.name+'"];'))(i)}for(var s=0,u=a.length;s<u;s++){a[s].fn(i,n[a[s].name])}i.prototype.constructor=i;if(n.declareName)r.define(n.declareName,i);return i};n.prototype.bindMethods=function(e){var t;if(typeof e=="string"){if(typeof this[e]=="function"){this[e]=this[e].bind(this)}return this}if(!e){for(t in this)this.bindMethods(t);return this}for(t=e.length;t--;)this.bindMethods(e[t]);return this};n.prototype.toString=function(){return"[object "+(this.constructor.NAME||"Declare")+"]"};n.NAME="atom.declare";n.invoke=function(){return this.factory(arguments)};n.own=function(e){r.addTo(this,e,this.NAME+".");return this};n.factory=function(e){s=true;return new this(e)};n.castArguments=function(e){if(e==null)return null;var t=this;return e!=null&&e[0]&&e[0]instanceof t?e[0]:e instanceof t?e:new t(e)};r={define:function(t,n){var r,i,s=e.global;t=t.split(".");r=t.pop();while(t.length){i=t.shift();if(!s[i]){s=s[i]={}}else{s=s[i]}}s[r]=n},mixin:function(e,n){if(!t.isArray(n))n=[n];for(var i=0,s=n.length;i<s;i++){r.addTo(e.prototype,r.proto(n[i]))}return this},addTo:function(e,t,r){var s,o;if(t)for(s in t)if(t.hasOwnProperty(s)){if(!i(t,e,s)&&t[s]!=n.config){o=t[s];if(u(o)){if(r)o.path=r+s;if(!o.previous&&u(e[s])){o.previous=e[s]}}e[s]=o}}return e},prepareParams:function(e,t,n){if(typeof e!="string"){n=t;t=e;e=null}if(n==null&&typeof t!="function"){n=t;t=null}if(!n)n={};if(!n.prototype)n={prototype:n};if(!n.name)n.name=e;if(!n.declareName)n.declareName=e;if(!n.parent&&t)n.parent=t;if(!n.prototype.initialize){n.prototype.initialize=function(){if(!n.parent)return;return n.parent.prototype.initialize.apply(this,arguments)}}return n},proto:function(e){o=true;var t=new e;o=false;return t},construct:function(e,t){if(s){t=t[0];s=false}if(o)return this;if(this instanceof e){if(e.NAME)this.Constructor=e.NAME;return this.initialize.apply(this,t)}else{return e.invoke.apply(e,t)}}};n.config={methods:r,mutator:e.core.overloadSetter(function(e,t){a.push({name:e,fn:t});return this})};n.config.mutator("parent",function(e,t){t=t||n;r.addTo(e,t);e.prototype=r.proto(t);e.Parent=t}).mutator("mixin",function(e,t){if(t)r.mixin(e,t)}).mutator("name",function(e,t){if(!t)return;e.NAME=t}).mutator("own",function(e,t){e.own(t)}).mutator("prototype",function(e,t){r.addTo(e.prototype,t,e.NAME+"#")});return e.declare=n}(o);o.Transition=function(e,t){var n=function(t){return e(t)};if(t){return v(n,{easeIn:n,easeOut:n,easeInOut:n})}return v(n,{easeIn:n,easeOut:function(t){return 1-e(1-t)},easeInOut:function(t){if(t>.5){return(2-e(2*(1-t)))/2}else{return e(2*t)/2}}})};o.Transition.set=o.core.overloadSetter(function(e,t){o.Transition[e]=o.Transition(t)});o.Transition.get=function(e){if(typeof e!="string")return e;var t=e.split("-")[0],n="easeInOut",r,i;if(t!=e){r=e.indexOf("-in")>0;i=e.indexOf("-out")>0;if(r^i){if(r)n="easeIn";if(i)n="easeOut"}}t=t[0].toUpperCase()+t.substr(1);if(!o.Transition[t]){throw new Error("No Transition method: "+t)}return o.Transition[t][n]};o.Transition.Linear=o.Transition(function(e){return e},true);o.Transition.set({Expo:function(e){return Math.pow(2,8*(e-1))},Circ:function(e){return 1-Math.sin(Math.acos(e))},Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Back:function(e){var t=1.618;return Math.pow(e,2)*((t+1)*e-t)},Bounce:function(e){var t,n=0,r=1;for(;;){if(e>=(7-4*n)/11){t=r*r-Math.pow((11-6*n-11*e)/4,2);break}n+=r,r/=2}return t},Elastic:function(e){return Math.pow(2,10*--e)*Math.cos(12*e)}});["Quad","Cubic","Quart","Quint"].forEach(function(e,t){o.Transition.set(e,function(e){return Math.pow(e,t+2)})});m("atom.Events",{initialize:function(e){this.context=e||this;this.locked=[];this.events={};this.actions={};this.readyList={}},exists:function(e){var t=this.events[this.removeOn(e)];return!!(t&&t.length)},add:function(e,t){this.run("addOne",e,t);return this},remove:function(e,t){if(typeof e=="string"&&!t){this.removeAll(e)}else{this.run("removeOne",e,t)}return this},fire:function(e,t){t=t?s.call(t):[];e=this.removeOn(e);this.locked.push(e);var n=0,r,i=this.events[e];if(i)for(r=i.length;n<r;n++){i[n].apply(this.context,t)}this.unlock(e);return this},ready:function(e,t){e=this.removeOn(e);this.locked.push(e);if(e in this.readyList){throw new Error("Event «"+e+"» is ready")}this.readyList[e]=t;this.fire(e,t);this.removeAll(e);this.unlock(e);return this},ensureReady:function(e,t){if(!(e in this.readyList)){this.ready(e,t)}return this},context:null,events:{},readyList:{},locked:[],actions:{},removeOn:function(e){return(e||"").replace(/^on([A-Z])/,function(e,t){return t.toLowerCase()})},removeAll:function(e){var t=this.events[e];if(t)for(var n=t.length;n--;){this.removeOne(e,t[n])}},unlock:function(e){var t,n=this.actions[e],r=this.locked.indexOf(e);this.locked.splice(r,1);if(n)for(r=0;r<n.length;r++){t=n[r];this[t.method](e,t.callback)}},run:function(e,n,r){var i=0,s=0;if(t.isArray(n)){for(i=0,s=n.length;i<s;i++){this[e](n[i],r)}}else if(typeof n=="object"){for(i in n){this[e](i,n[i])}}else if(typeof n=="string"){this[e](n,r)}else{throw new TypeError("Wrong arguments in Events."+e)}},register:function(e,t,n){var r=this.actions;if(!r[e]){r[e]=[]}r[e].push({method:t,callback:n})},addOne:function(e,t){var n,r,i;e=this.removeOn(e);if(this.locked.indexOf(e)==-1){r=this.readyList[e];if(r){i=this.context;setTimeout(function(){t.apply(i,r)},0);return this}else{n=this.events;if(!n[e]){n[e]=[t]}else{n[e].push(t)}}}else{this.register(e,"addOne",t)}},removeOne:function(e,t){e=this.removeOn(e);if(this.locked.indexOf(e)==-1){var n=this.events[e],r=n.length;while(r--)if(n[r]==t){n.splice(r,1)}}else{this.register(e,"removeOne",t)}}});var g=o.Events;m("atom.Settings",{recursive:false,values:{},initialize:function(e){this.values={};if(e)this.set(e)},addEvents:function(e){this.events=e;return this.invokeEvents()},get:function(e,n){if(t.isArray(e))return this.subset(e,n);return e in this.values?this.values[e]:n},properties:function(e,t){var n=this.propertiesNames;if(typeof t=="string"){t=t.split(" ")}if(t==null||t===true){this.propertiesNames=true}else if(n==null){this.propertiesNames=t}else if(n!==true){o.array.append(n,t)}this.propertiesTarget=e;for(var r in this.values){this.exportProperty(r,this.values)}return this},subset:function(e,t){var n,r={};for(n=e.length;n--;){r[e[n]]=this.get(e[n],t)}return r},propertiesNames:null,propertiesTarget:null,set:function(e,t){var n,r=this.values;e=this.prepareOptions(e,t);for(n in e){t=e[n];if(r[n]!=t){r[n]=t;this.exportProperty(n,r)}}this.invokeEvents();return this},exportProperty:function(e,t){var n=this.propertiesTarget,r=this.propertiesNames;if(n&&(r===true||r.indexOf(e)>=0)){n[e]=t[e]}},prepareOptions:function(e,t){if(typeof e=="string"){var n=e;e={};e[n]=t}else if(e instanceof this.constructor){e=e.values}return e},unset:function(e){delete this.values[e];return this},invokeEvents:function(){if(!this.events)return this;var e=this.values,t,n;for(t in e)if(e.hasOwnProperty(t)){n=e[t];if(this.isInvokable(t,n)){this.events.add(t,n);this.unset(t)}}return this},isInvokable:function(e,t){return e&&t&&u(t)&&/^on[A-Z]/.test(e)}});var y=o.Settings;o.object={append:function(e,t,n){for(var r=1,i=arguments.length;r<i;r++){o.core.append(e,arguments[r])}return e},invert:function(e){var t={};for(var n in e)t[e[n]]=n;return t},collect:function(e,t,n){var r={};t.forEach(function(t){r[t]=t in e?e[t]:n});return r},values:function(e){var t=[];for(var n in e)t.push(e[n]);return t},isDefined:function(e){return typeof e!=="undefined"},isReal:function(e){return e!=null},map:function(e,t){var n={};for(var r in e)if(e.hasOwnProperty(r)){n[r]=t(e[r],r,e)}return n},max:function(e){var t=null,n=null;for(var r in e)if(t==null||e[r]>t){n=r;t=e[r]}return n},min:function(e){var t=null,n=null;for(var r in e)if(t==null||e[r]<t){n=r;t=e[r]}return n},deepEquals:function(t,n){if(!t||typeof t!==typeof n)return false;for(var r in t){var i=t[r],s=n[r];if(typeof i==="object"){if(!s||!e.deepEquals(i,s))return false}else if(i!==s){return false}}for(r in n)if(!(r in t))return false;return true},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t)){return false}return true},ifEmpty:function(e,t,n){if(!(t in e)){e[t]=n}return e},path:{parts:function(e,n){return t.isArray(e)?e:String(e).split(n||".")},get:function(e,t,n){if(!t)return e;t=o.object.path.parts(t,n);for(var r=0;r<t.length;r++){if(e!=null&&t[r]in e){e=e[t[r]]}else{return}}return e},set:function(e,t,n,r){t=o.object.path.parts(t,r);var i=t.pop();while(t.length){var s=t.shift();if(e[s]){e=e[s]}else{e=e[s]={}}}e[i]=n}}};m("atom.Animatable",{element:null,initialize:function(e,t){this.bindMethods("animate");this.context=t||null;if(!e)throw new TypeError("callbacks cant be null");this.animations=[];if(this.isValidCallbacks(e)){this.callbacks=e}else{this.callbacks=this.getDefaultCallbacks(e)}},get current(){return this.animations[0]},animate:o.core.ensureObjectSetter(function(e){return this.next(new o.Animatable.Animation(this,e))}),stop:function(e){var t=this.current;if(t){if(e)this.animations.length=0;t.destroy("stop")}return this},getDefaultCallbacks:function(e){return{get:function(t){return o.object.path.get(e,t)},set:o.core.overloadSetter(function(t,n){return o.object.path.set(e,t,n)})}},isValidCallbacks:function(t){return typeof t=="object"&&e.keys(t).length==2&&u(t.set)&&u(t.get)},animations:null,next:function(e){var t=this.animations;if(e){t.push(e);if(t.length==1){this.launch(e)}}else if(t.length){this.launch(this.current)}return e},launch:function(e){var t=this.animations,n=this;e.events.add("destroy",function r(){t.splice(t.indexOf(e),1);e.events.remove("destroy",r);n.next()});e.start()},get:function(e){return this.callbacks.get.apply(this.context,arguments)},set:function(e,t){return this.callbacks.set.apply(this.context,arguments)}});m("atom.Animatable.Animation",{animatable:null,initial:null,target:null,initialize:function(e,t){this.bindMethods(["tick","start"]);if(!t.props)t={props:t};this.events=new o.Events(e);this.settings=(new o.Settings({fn:"linear",time:500})).set(t).addEvents(this.events);this.animatable=e;this.transition=o.Transition.get(this.settings.get("fn"));this.allTime=this.settings.get("time");this.target=this.settings.get("props")},start:function(){this.initial=this.fetchInitialValues();this.delta=this.countValuesDelta();this.timeLeft=this.allTime;this.events.fire("start",[this]);o.frame.add(this.tick);return this},countValuesDelta:function(){var e=this.initial;return o.object.map(this.target,function(t,n){var r=e[n];if(o.Color&&r instanceof o.Color){return r.diff(new o.Color(t))}else{return t-r}})},fetchInitialValues:function(){var e=this.animatable;return o.object.map(this.target,function(t,n){var r=e.get(n);if(o.Color&&o.Color.isColorString(t)||t instanceof o.Color){if(!r){r=new o.Color(t);r.alpha=0;return r}return new o.Color(r)}else if(isNaN(r)){throw new Error("value is not animatable: "+r)}else{return r}})},changeValues:function(e){var t=this.delta,n=this.animatable,r,i;for(var s in t)if(t.hasOwnProperty(s)){if(e==null){i=this.target[s];n.set(s,o.Color&&i instanceof o.Color?i.toString():i)}else{r=this.initial[s];n.set(s,o.Color&&r instanceof o.Color?r.clone().move(t[s].clone().mul(e)).toString():r+t[s]*e)}}},tick:function(e){var t=e>=this.timeLeft;this.timeLeft=t?0:this.timeLeft-e;this.changeValues(this.transition(t?1:(this.allTime-this.timeLeft)/this.allTime));this.events.fire("tick",[this]);if(t)this.destroy("complete")},destroy:function(e){if(!e)e="error";this.events.fire(e,[this]);this.events.fire("destroy",[this]);o.frame.remove(this.tick);return this}});if(o.dom)(function(e){var t={get:function(e){var t=this.css(e);return o.Color&&o.Color.isColorString(t)?t:parseFloat(t)},set:function(e,t){this.css(e,t)}};o.dom.prototype.animate=o.core.ensureObjectSetter(function(n){this.each(function(r){if(!r[e]){r[e]=new o.Animatable(t,o.dom(r))}r[e].animate(n)});return this});o.dom.prototype.stopAnimation=function(t){this.each(function(n){if(n[e]){n[e].stop(t)}});return this}})("atom.animatable");m("atom.Settings.Mixin",{settings:null,options:{},setOptions:function(e){if(!this.settings){this.settings=new o.Settings(o.clone(this.options||{}));this.options=this.settings.values}for(var t=0;t<arguments.length;t++){this.settings.set(arguments[t])}return this}});m("atom.Events.Mixin",new function(){var e=function(){var e=this.__events;if(!e)e=this.__events=new o.Events(this);if(this._events){for(var t in this._events)if(t!="$ready"){this._events[t].forEach(function(n){e.add(t,n)})}}return e};var t=function(t,n){return function(){var r,i=e.call(this);r=i[t].apply(i,arguments);return n?r:this}};return{get events(){return e.call(this)},set events(e){this.__events=e},isEventAdded:t("exists",true),addEvent:t("add",false),removeEvent:t("remove",false),fireEvent:t("fire",false),readyEvent:t("ready",false)}});m("atom.Color",{initialize:function(e){var n=arguments,r;if(n.length==4||n.length==3){e=s.call(n)}else if(e&&e.length==1){e=e[0]}r=typeof e;if(t.isArray(e)){this.fromArray(e)}else if(r=="number"){this.fromNumber(e)}else if(r=="string"){this.fromString(e)}else if(r=="object"){this.fromObject(e)}else{throw new TypeError("Unknown type in atom.Color: "+typeof e+";\n"+e)}},r:0,g:0,b:0,a:1,length:4,noLimits:false,get red(){return this.r},get green(){return this.g},get blue(){return this.b},get alpha(){return this.a},set red(e){this.setValue("r",e)},set green(e){this.setValue("g",e)},set blue(e){this.setValue("b",e)},set alpha(e){this.setValue("a",e,true)},safeAlphaSet:function(e){if(e!=null){this.alpha=Math.round(e*1e3)/1e3}},setValue:function(e,t,n){t=Number(t);if(t!=t){throw new TypeError("Value is NaN ("+e+"): "+t)}if(!n)t=Math.round(t);this[e]=this.noLimits?t:o.number.limit(t,0,n?1:255)},fromArray:function(e){if(!e||e.length<3||e.length>4){throw new TypeError("Wrong array in atom.Color: "+e)}this.red=e[0];this.green=e[1];this.blue=e[2];this.safeAlphaSet(e[3]);return this},fromObject:function(e){function t(t,n){return e[t]!=null?e[t]:e[n]}if(typeof e!="object"){throw new TypeError('Not object in "fromObject": '+typeof e)}this.red=t("r","red");this.green=t("g","green");this.blue=t("b","blue");this.safeAlphaSet(t("a","alpha"));return this},fromString:function(e){if(!this.constructor.isColorString(e)){throw new TypeError('Not color string in "fromString": '+e)}var t,n;e=e.toLowerCase();e=this.constructor.colorNames[e]||e;if(t=e.match(/^#(\w{1,2})(\w{1,2})(\w{1,2})(\w{1,2})?$/)){n=o.array.clean(t.slice(1));n=n.map(function(e){if(e.length==1)e+=e;return parseInt(e,16)});if(n.length==4)n[3]/=255}else{n=e.match(/([\.\d]{1,})/g).map(Number)}return this.fromArray(n)},fromNumber:function(e){if(typeof e!="number"||e<0||e>4294967295){throw new TypeError('Not color number in "fromNumber": '+e.toString(16))}return this.fromArray([e>>24&255,e>>16&255,e>>8&255,(e&255)/255])},toArray:function(){return[this.r,this.g,this.b,this.a]},toString:function(e){var t=this.toArray();if(e=="hex"||e=="hexA"){return"#"+t.map(function(t,n){if(n==3){if(e=="hex")return"";t=Math.round(t*255)}var r=t.toString(16);return r.length==1?"0"+r:r}).join("")}else{return"rgba("+t+")"}},toNumber:function(){return parseInt(this.toString("hexA").substr(1),16)},toObject:function(e){return e?{r:this.r,g:this.g,b:this.b,a:this.a}:{red:this.r,green:this.g,blue:this.b,alpha:this.a}},diff:function(e){e=o.Color(e);return new o.Color.Shift([e.red-this.red,e.green-this.green,e.blue-this.blue,e.alpha-this.alpha])},move:function(e){e=o.Color.Shift(e);this.red+=e.red;this.green+=e.green;this.blue+=e.blue;this.alpha+=e.alpha;return this},shift:function(e){return this.clone().move(e)},map:function(e){var t=this;["red","green","blue","alpha"].forEach(function(n){t[n]=e.call(t,t[n],n,t)});return t},add:function(e){return this.map(function(t){return t+e})},mul:function(e){return this.map(function(t){return t*e})},equals:function(e){return e&&e instanceof this.constructor&&e.red==this.red&&e.green==this.green&&e.blue==this.blue&&e.alpha==this.alpha},dump:function(){return"[atom.Color("+this.toString("hexA")+")]"},clone:function(){return new this.constructor(this)}}).own({invoke:m.castArguments,isColorString:function(e){if(typeof e!="string")return false;return Boolean(e in this.colorNames||e.match(/^#\w{3,6}$/)||e.match(/^rgba?\([\d\., ]+\)$/))},colorNames:{white:"#ffffff",silver:"#c0c0c0",gray:"#808080",black:"#000000",red:"#ff0000",maroon:"#800000",yellow:"#ffff00",olive:"#808000",lime:"#00ff00",green:"#008000",aqua:"#00ffff",teal:"#008080",blue:"#0000ff",navy:"#000080",fuchsia:"#ff00ff",purple:"#800080",orange:"#ffa500"},random:function(e){var t,n=o.number.random;if(e){t=o.array.random(this.colorNamesList)}else{t=[n(0,255),n(0,255),n(0,255)]}return new this(t)}});o.Color.colorNamesList=e.keys(o.Color.colorNames);m("atom.Color.Shift",o.Color,{noLimits:true});o.declare("atom.ImagePreloader",{processed:0,number:0,initialize:function(e){this.events=new g(this);this.settings=(new y(e)).addEvents(this.events);this.count={error:0,abort:0,load:0};this.suffix=this.settings.get("suffix")||"";this.usrImages=this.prefixImages(this.settings.get("images"));this.imageUrls=this.fetchUrls();this.domImages={};this.images={};this.createNext()},get isReady(){return this.number==this.processed},get info(){var e=o.string.substitute("Images loaded: {load}; Errors: {error}; Aborts: {abort}",this.count);if(this.isReady)e="Image preloading has completed;\n"+e;return e},get progress(){return this.isReady?1:o.number.round(this.processed/this.number,4)},append:function(e){for(var t in e.images){this.images[t]=e.images[t]}return this},exists:function(e){return!!this.images[e]},get:function(e){var t=this.images[e];if(t){return t}else{throw new Error("No image «"+e+"»")}},cropImage:function(e,t){if(!t)return e;var n=document.createElement("canvas");n.width=t[2];n.height=t[3];n.getContext("2d").drawImage(e,t[0],t[1],t[2],t[3],0,0,t[2],t[3]);return n},withoutPrefix:function(e){return e.indexOf("http://")===0||e.indexOf("https://")===0},prefixImages:function(e){var t=this.settings.get("prefix");if(!t)return e;return o.object.map(e,function(e){return this.withoutPrefix(e)?e:t+e}.bind(this))},cutImages:function(){var e,t,n;for(e in this.usrImages)if(this.usrImages.hasOwnProperty(e)){t=this.splitUrl(this.usrImages[e]);n=this.domImages[t.url];this.images[e]=this.cropImage(n,t.coords)}return this},splitUrl:function(e){var t=e,n,r,i,s=null;if(i=e.match(/ \[(\d+):(\d+):(\d+):(\d+)\]$/)){s=i.slice(1)}else if(i=e.match(/ \[(\d+):(\d+)\]\{(\d+):(\d+)\}$/)){s=i.slice(1).map(Number);n=s.slice(0,2);r=s.slice(2,4);s=[r[0]*n[0],r[1]*n[1],n[0],n[1]]}if(i){t=e.substr(0,e.lastIndexOf(i[0]));s=s.map(Number)}if(this.suffix){if(typeof this.suffix=="function"){t=this.suffix(t)}else{t+=this.suffix}}return{url:t,coords:s}},fetchUrls:function(){var e,t=[],n={},r,i=this.usrImages;for(e in i)if(i.hasOwnProperty(e)){r=this.splitUrl(i[e]).url;if(!n[r]){t.push(r);n[r]=true;this.number++}}return t},createDomImage:function(e){var t=new Image;t.src=e;if(window.opera&&t.complete){setTimeout(this.onProcessed.bind(this,"load",t),10)}else{["load","error","abort"].forEach(function(e){t.addEventListener(e,this.onProcessed.bind(this,e,t),false)}.bind(this))}return t},createNext:function(){if(this.imageUrls.length){var e=this.imageUrls.shift();this.domImages[e]=this.createDomImage(e)}},resetImage:function(e){e.width=e.width;e.height=e.height;e.naturalWidth=e.naturalWidth;e.naturalHeight=e.naturalHeight},onProcessed:function(e,t){if(e=="load"&&window.opera){this.resetImage(t)}this.count[e]++;this.processed++;this.events.fire("progress",[this,t]);if(this.isReady){this.cutImages();this.events.ensureReady("ready",[this])}else{this.createNext()}return this}}).own({run:function(e,t,n){var r=new this({images:e});r.events.add("ready",n?t.bind(n):t);return r}});var b=function(){var e,n={},r={a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,n0:48,n1:49,n2:50,n3:51,n4:52,n5:53,n6:54,n7:55,n8:56,n9:57,tab:9,enter:13,shift:16,backspace:8,ctrl:17,alt:18,esc:27,space:32,menu:93,pause:19,cmd:91,insert:45,home:36,pageup:33,"delete":46,end:35,pagedown:34,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,np0:96,np1:97,np2:98,np3:99,np4:100,np5:101,np6:102,np7:103,np8:104,np9:105,npslash:11,npstar:106,nphyphen:109,npplus:107,npdot:110,capslock:20,numlock:144,scrolllock:145,equals:61,hyphen:109,coma:188,dot:190,gravis:192,backslash:220,sbopen:219,sbclose:221,slash:191,semicolon:59,apostrophe:222,aleft:37,aup:38,aright:39,adown:40};for(e in r)if(r.hasOwnProperty(e)){n[r[e]]=e}return m("atom.Keyboard",{initialize:function(e,n){if(t.isArray(e)){n=e;e=null}if(e==null)e=document;if(e==document){if(this.constructor.instance){return this.constructor.instance}this.constructor.instance=this}this.events=new g(this);this.keyStates={};this.preventDefault=n;o.dom(e).bind({keyup:this.keyEvent("up"),keydown:this.keyEvent("down"),keypress:this.keyEvent("press")})},keyEvent:function(e){return this.onKeyEvent.bind(this,e)},onKeyEvent:function(e,t){var n=this.constructor.keyName(t),r=this.prevent(n);t.keyName=n;if(r)t.preventDefault();this.events.fire(e,[t]);if(e=="down"){this.events.fire(n,[t]);this.keyStates[n]=true}else if(e=="up"){this.events.fire(n+":up",[t]);delete this.keyStates[n]}else if(e=="press"){this.events.fire(n+":press",[t])}return!r},prevent:function(e){var t=this.preventDefault;return t&&(t===true||t.indexOf(e)>=0)},key:function(e){return!!this.keyStates[this.constructor.keyName(e)]}}).own({keyCodes:r,codeNames:n,keyName:function(e){if(e&&e.keyCode!=null){e=e.keyCode}var t=typeof e;if(t=="number"){return this.codeNames[e]}else if(t=="string"&&e in this.keyCodes){return e}return null}})}();m("atom.Registry",{items:{},initialize:function(e){this.items={};if(e)this.set(e)},set:o.core.overloadSetter(function(e,t){this.items[e]=t}),get:o.core.overloadGetter(function(e){return this.items[e]})});var w=o.Registry;o.trace=m("atom.trace",{initialize:function(e){this.value=e;this.stopped=false},set value(e){if(!this.stopped){var t=o.string.replaceAll(this.constructor.dump(e),{"	":"&nbsp;".repeat(3),"\n":"<br />"});this.createNode().html(t)}},destroy:function(e){var t=this;if(e)this.stop();if(t.node){t.node.addClass("atom-trace-node-destroy");t.timeout=setTimeout(function(){if(t.node){t.node.destroy();t.node=null}},500)}return t},stop:function(){this.stopped=true;return this},getContainer:function(){var e=o.dom("#atom-trace-container");return e.length?e:o.dom.create("div",{id:"atom-trace-container"}).appendTo("body")},trace:function(e){this.value=e;return this},createNode:function(){var e=this,t=e.node;if(t){if(e.timeout){clearTimeout(e.timeout);t.removeClass("atom-trace-node-destroy")}return t}return e.node=o.dom.create("div").addClass("atom-trace-node").appendTo(e.getContainer()).bind({click:function(){e.destroy(0)},dblclick:function(){e.destroy(1)}})}}).own({dumpRec:function S(e,t,n){function a(e){return n?e:o.string.safeHtml(e)}function f(e,r){return s+"	"+r+": "+S(e,t+1,n)+"\n"}var r="",i,s;t=parseInt(t)||0;if(t>5)return"*TOO_DEEP*";if(e&&typeof e=="object"&&u(e.dump))return e.dump();i=o.typeOf(e);s="	".repeat(t);switch(i){case"object":for(var l in e)if(e.hasOwnProperty(l)){r+=f(e[l],l)}return"{\n"+r+s+"}";case"element":var c=e.width&&e.height?"("+e.width+"×"+e.height+")":"";return"[DOM "+e.tagName.toLowerCase()+c+"]";case"textnode":case"whitespace":return"[DOM "+i+"]";case"array":return"[\n"+e.map(f).join("")+s+"]";case"null":return"null";case"boolean":return e?"true":"false";case"string":return a('"'+e+'"');default:return a(""+e)}},dumpPlain:function(e){return this.dumpRec(e,0,true)},dump:function(e){return this.dumpRec(e,0)}});o.number={randomFloat:function(e,t){return Math.random()*(e-t)+t},random:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},between:function(e,t,n,r){e=Number(e);t=Number(t);n=Number(n);return t<=n&&(r=="L"&&e==t||r=="R"&&e==n||e>t&&e<n||[true,"LR","RL"].indexOf(r)!=-1&&(t==e||n==e))},equals:function(e,t,n){if(n==null)n=8;return e.toFixed(n)==t.toFixed(n)},limit:function(e,t,n){var r=Math.max(t,Number(e));return n!=null?Math.min(n,r):r},round:function(e,t){if(!t)return Math.round(e);if(t<0){t=Number(Math.pow(10,t).toFixed(-t))}else{t=Math.pow(10,t)}return Math.round(e*t)/t},stop:function(e){e=Number(e);if(e){clearInterval(e);clearTimeout(e)}return this}};o.array={is:function(e){return t.isArray(e)},range:function(e,t,n){e=Number(e);t=Number(t);n=Number(n);if(typeof e!="number")throw new TypeError("`from` should be number");if(typeof t!="number")throw new TypeError("`to` should be number");var r=t>e,i=n>0;if(!n){n=r?1:-1}else if(r!=i){throw new RangeError("step direction is wrong")}var s=[];do{s.push(e);e+=n}while(r?e<=t:e>=t);return s},from:function(e){if(e==null)return[];return!d(e)?[e]:t.isArray(e)?e:s.call(e)},pickFrom:function(e){var t=e&&e.length==1&&d(e[0]);return o.array.from(t?e[0]:e)},fill:function(e,n){e=t.isArray(e)?e:new t(Number(e));for(var r=e.length;r--;)e[r]=n;return e},fillMatrix:function(e,n,r){var i=new t(n);while(n--){i[n]=t.fill(e,r)}return i},collect:function(e,t,n){var r=[],i=0,s=t.length,o;for(;i<s;i++){o=t[i];r.push(o in e?e[o]:n)}return r},create:function(e,n,r){if(!u(n)){throw new TypeError("callback should be function")}var i=new t(Number(e));for(var s=0;s<e;s++){i[s]=n.call(r,s,i)}return i},toHash:function(e){var t={},n=0,r=e.length;for(;n<r;n++){t[n]=e[n]}return t},last:function(e){return e.length?e[e.length-1]:null},randomIndex:function(e){if(e.length==0)return null;return o.number.random(0,e.length-1)},random:function(e,t){if(e.length==0)return null;var n=o.array.randomIndex(e);return t?e.splice(n,1)[0]:e[n]},property:function(e,t){return e.map(function(e){return e!=null?e[t]:null})},fullMap:function(e,n,r){var i=new t(e.length);for(var s=0,o=i.length;s<o;s++){i[s]=n.call(r,e[s],s,e)}return i},contains:function(e,t,n){return e.indexOf(t,n)!=-1},include:l,erase:h,append:function(e,t){for(var n=1,r=arguments.length;n<r;n++)if(arguments[n]){e.push.apply(e,arguments[n])}return e},toKeys:function(e){var t=arguments.length==1,n={};for(var r=0,i=this.length;r<i;r++)n[this[r]]=t?e:r;return n},combine:function(e,t){for(var n=0,r=t.length;n<r;n++){o.array.include(e,t[n])}return e},pick:function(e){for(var t=0,n=e.length;t<n;t++){if(e[t]!=null)return e[t]}return null},invoke:function(e,t){var n=s.call(arguments,2);if(typeof t=="string"){var r=t;t=null}return e.map(function(e){return e&&(r?e[r]:e).apply(r?e:t,n)})},shuffle:function(e){var t,n,r=e.length;while(r--){n=o.number.random(0,r);t=e[r];e[r]=e[n];e[n]=t}return e},sortBy:function(e,t,n){var r=function(e){return(u(e[t])?e[t]():e[t])||0};var i=n?-1:1;return e.sort(function(e,t){var n=r(t)-r(e);return n?(n<0?-1:1)*i:0})},min:function(e){return Math.min.apply(null,e)},max:function(e){return Math.max.apply(null,e)},mul:function(e,t){for(var n=e.length;n--;)e[n]*=t;return e},add:function(e,t){for(var n=e.length;n--;)e[n]+=t;return e},sum:function(e){for(var t=0,n=e.length;n--;)t+=e[n];return t},product:function(e){for(var t=1,n=e.length;n--;)t*=e[n];return t},average:function(e){return e.length?o.array.sum(e)/e.length:0},unique:function(e){return o.array.combine([],e)},associate:function(e,t){var n=0,r={},i=e.length,s=u(t),o=s?e:t;if(!s)i=Math.min(i,t.length);for(;n<i;n++){r[o[n]]=s?t(e[n],n):e[n]}return r},clean:function(e){return e.filter(function(e){return e!=null})},empty:function(e){e.length=0;return e},clone:function(e){return o.clone(e)},hexToRgb:function(e,t){if(e.length!=3)return null;var n=e.map(function(e){if(e.length==1)e+=e;return parseInt(e,16)});return t?n:"rgb("+n+")"},rgbToHex:function(e,t){if(e.length<3)return null;if(e.length==4&&e[3]==0&&!t)return"transparent";var n=[],r=0,i;for(;r<3;r++){i=(e[r]-0).toString(16);n.push(i.length==1?"0"+i:i)}return t?n:"#"+n.join("")},reduce:function(e,t,r){if(u(e.reduce))return e.reduce(t,r);for(var i=0,s=e.length;i<s;i++)if(i in e){r=r===n?e[i]:t.call(null,r,e[i],i,e)}return r},reduceRight:function(e,t,r){if(u(e.reduceRight))return e.reduceRight(t,r);for(var i=e.length;i--;)if(i in e){r=r===n?e[i]:t.call(null,r,e[i],i,e)}return r}};var E={callbacks:[],fn:function(e){return function(t){return function(){var n=s.call(arguments);n.unshift(this);return e[t].apply(e,n)}}},proto:function(e,t,n){v(e.prototype,o.array.associate(n.split(" "),t));return E},own:function(e,t,n){v(e,o.object.collect(t,n.split(" ")));return E},add:function(e){this.callbacks.push(e)}};o.patching=function(e){E.callbacks.forEach(function(t){t(e)})};E.add(function(e){var t=e.Array;var n=E.fn(o.array);E.own(t,o.array,"range from pickFrom fill fillMatrix collect create toHash").proto(t,n,"randomIndex property contains include append erase combine pick invoke shuffle sortBy min max mul add sum product average unique associate clean empty clone hexToRgb rgbToHex");o.accessors.define(t.prototype,{last:{get:function(){return o.array.last(this)}},random:{get:function(){return o.array.random(this,false)}}});v(t.prototype,{popRandom:function(){return o.array.random(this,true)},toKeys:function(){console.log("[].toKeys is deprecated. Use forEach instead");return o.array.toKeys(this)},fullMap:function(e,t){console.log("[].fullMap is deprecated. Use atom.array.create instead");return o.array.create(this.length,e,t)}});if(!t.prototype.reduce)t.prototype.reduce=n("reduce");if(!t.prototype.reduceRight)t.prototype.reduceRight=n("reduceRight")});o.fn={lambda:function(e){var t=arguments.length==0;return function(){return t?this:e}},after:function(e,t){function i(){for(var t in n)if(!r[t])return;e(r)}var n={},r={};s.call(arguments,1).forEach(function(e){n[e]=function(){r[e]=s.call(arguments);r[e].context=this;i()}});return n}};E.add(function(e){function n(e){var t=e?setInterval:setTimeout;return function(e,n,r){var i=this;return t(function(){i.apply(n,r||[])},e)}}var t=e.Function;t.lambda=o.fn.lambda;v(t.prototype,{after:E.fn(o.fn)("after"),delay:n(false),periodical:n(true)})});(function(){var e=Math.PI/180,t=Math.PI*2;o.math={DEGREE360:t,degree:function(t){return t*e},getDegree:function(t,n){t/=e;return n?Math.round(t):t},normalizeAngle:function(e){e%=t;return e+(e<0?t:0)},hypotenuse:function(e,t){return Math.sqrt(e*e+t*t)},cathetus:function(e,t){return Math.sqrt(e*e-t*t)}}})();E.add(function(e){var t=e.Number;E.own(t,o.number,"random randomFloat").proto(t,E.fn(o.number),"between equals limit round stop").proto(t,E.fn(o.math),"degree getDegree normalizeAngle");v(t.prototype,{toFloat:function(){return parseFloat(this)},toInt:function(e){return parseInt(this,e||10)}});"abs acos asin atan atan2 ceil cos exp floor log max min pow sin sqrt tan".split(" ").forEach(function(e){if(t[e])return;t.prototype[e]=function(){return Math[e].apply(null,[this].append(arguments))}})});E.add(function(e){v(e.Object,o.object)});new function(){var e=Date.now();o.string={uniqueID:function(){return(e++).toString(36)},safeHtml:function(e){return this.replaceAll(e,/[<'&">]/g,{"&":"&","'":"&#039;",'"':"&quot;","<":"&lt;",">":"&gt;"})},repeat:function(e,n){return(new t(n+1)).join(e)},substitute:function(e,t,n){return e.replace(n||/\\?\{([^{}]+)\}/g,function(e,n){return e[0]=="\\"?e.slice(1):t[n]==null?"":t[n]})},replaceAll:function(e,t,n){if(r.call(t)=="[object RegExp]"){return e.replace(t,function(e){return n[e]})}else if(typeof t=="object"){for(var i in t)e=this.replaceAll(e,i,t[i]);return e}return e.split(t).join(n)},contains:function(e,t){return e?e.indexOf(t)>=0:false},begins:function(e,t,n){if(!e)return false;return!n?t==e.substr(0,t.length):t.toLowerCase()==e.substr(0,t.length).toLowerCase()},ends:function(e,t,n){if(!e)return false;return!n?t==e.substr(e.length-t.length):t.toLowerCase()==e.substr(e.length-t.length).toLowerCase()},ucfirst:function(e){return e?e[0].toUpperCase()+e.substr(1):""},lcfirst:function(e){return e?e[0].toLowerCase()+e.substr(1):""}}};E.add(function(e){E.proto(e.String,E.fn(o.string),"safeHtml repeat substitute replaceAll contains begins ends ucfirst lcfirst")})}).call(typeof exports=="undefined"?window:exports,Object,Array)